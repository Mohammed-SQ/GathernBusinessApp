<?xml version="1.0" encoding="utf-8"?>
<ContentPage
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    x:Class="GathernBusinessApp.AddPropertyPage"
    BackgroundColor="White"
    Shell.NavBarIsVisible="False"
    FlowDirection="RightToLeft">

    <!-- Root grid: scrollable content + fixed bottom bar -->
    <Grid RowDefinitions="*,Auto">
        <ScrollView Grid.Row="0">
            <HorizontalStackLayout HorizontalOptions="Center" Padding="0,20">
                <VerticalStackLayout WidthRequest="500" Spacing="24">

                    <!-- HEADER (shared, always on top) -->
                    <Grid
                        ColumnDefinitions="*,Auto"
                        FlowDirection="LeftToRight"
                        Padding="20,10">

                        <!-- Page title centered -->
                        <Label
                            Grid.Column="0"
                            x:Name="TitleLabel"
                            Text="Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¹Ù‚Ø§Ø±"
                            FontSize="35"
                            FontAttributes="Bold"
                            TextColor="Black"
                            VerticalOptions="Center"
                            HorizontalOptions="End" />

                        <!-- Back arrow on the right -->
                        <Button
                            Grid.Column="1"
                            x:Name="BackButton"
                            Text=">"
                            Margin="0,0,-15,-20"
                            FontSize="35"
                            FontAttributes="Bold"
                            BackgroundColor="Transparent"
                            TextColor="Black"
                            WidthRequest="40"
                            Clicked="OnBackClicked"
                            VerticalOptions="Center"
                            HorizontalOptions="End" />
                    </Grid>

                    <!-- STEP 1: Property Name + Category Selection -->
                    <VerticalStackLayout
                        x:Name="Step1"
                        Spacing="16"
                        Padding="20,0"
                        IsVisible="True">

                        <!-- Property Name -->
                        <Label
                            Text="Ø§Ø³Ù… Ø¹Ù‚Ø§Ø±Ùƒ"
                            FontSize="16"
                            FontAttributes="Bold"
                            TextColor="Black"
                            HorizontalOptions="Start" />

                        <Entry
                            x:Name="PropertyNameEntry"
                            Text="ÙÙ†Ø¯Ù‚"
                            Placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ø¹Ù‚Ø§Ø±"
                            FontSize="14"
                            TextColor="Black"
                            BackgroundColor="#F5F5F5"
                            HeightRequest="50"
                            HorizontalOptions="Fill" />

                        <!-- Category Labels -->
                        <Label
                            Text="ØªØµÙ†ÙŠÙ Ø¹Ù‚Ø§Ø±Ùƒ"
                            FontSize="18"
                            FontAttributes="Bold"
                            TextColor="Black"
                            HorizontalOptions="Start" />
                        <Label
                            Text="Ø­Ø¯Ø¯ Ø§Ù„ØªØµÙ†ÙŠÙ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨"
                            FontSize="14"
                            TextColor="Gray"
                            HorizontalOptions="Start" />

                        <!-- 3Ã—3 Category Grid -->
                        <CollectionView
                            x:Name="CategoryGrid"
                            SelectionMode="Single"
                            HeightRequest="460"
                            HorizontalOptions="Center">
                            <CollectionView.ItemsLayout>
                                <GridItemsLayout
                                    Orientation="Vertical"
                                    Span="3"
                                    HorizontalItemSpacing="10"
                                    VerticalItemSpacing="10" />
                            </CollectionView.ItemsLayout>
                            <CollectionView.ItemTemplate>
                                <DataTemplate>
                                    <Border
                                        BackgroundColor="#F5F5F5"
                                        Stroke="Transparent"
                                        Padding="0"
                                        HeightRequest="120"
                                        WidthRequest="120">
                                        <Border.StrokeShape>
                                            <RoundRectangle CornerRadius="12" />
                                        </Border.StrokeShape>
                                        <VisualStateManager.VisualStateGroups>
                                            <VisualStateGroup Name="CommonStates">
                                                <VisualState Name="Normal" />
                                                <VisualState Name="Selected">
                                                    <VisualState.Setters>
                                                        <Setter Property="Stroke" Value="#6200EE" />
                                                        <Setter Property="StrokeThickness" Value="3" />
                                                    </VisualState.Setters>
                                                </VisualState>
                                            </VisualStateGroup>
                                        </VisualStateManager.VisualStateGroups>
                                        <Grid>
                                            <Image Source="{Binding Image}" Aspect="AspectFill" />
                                            <Label
                                                Text="{Binding Name}"
                                                TextColor="White"
                                                FontAttributes="Bold"
                                                HorizontalOptions="End"
                                                VerticalOptions="End"
                                                Margin="8" />
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </CollectionView.ItemTemplate>
                        </CollectionView>
                    </VerticalStackLayout>

                    <!-- STEP 2: Property Location -->
                    <VerticalStackLayout x:Name="Step2" Spacing="16" IsVisible="False">
                        <Label Text="Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¹Ù‚Ø§Ø±"
                               FontSize="18" FontAttributes="Bold" />
                        <WebView HeightRequest="300"
                                 Source="" />
                        <Frame BackgroundColor="#F5F5F5" BorderColor="#E0E0E0" CornerRadius="12" HasShadow="False" HeightRequest="60">
                            <Label Text="ECAB8351, 3679, Ø§Ù„ØªØ­Ù„ÙŠØ©, Ø§Ù„Ø®Ø¨Ø± 34717, Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©"
                                   FontSize="14" VerticalOptions="Center" Margin="10,0" />
                        </Frame>
                        <Label Text="ØªØ£ÙƒÙŠØ¯ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¹Ù‚Ø§Ø±"
                               FontSize="18" FontAttributes="Bold" />
                        <Label Text="Ø­Ø¯Ø¯ Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© ÙˆØ§Ù„Ø­ÙŠ ÙˆØ§Ù„Ø§ØªØ¬Ø§Ù‡"
                               FontSize="14" TextColor="Gray" />
                        <Frame BackgroundColor="#F5F5F5" BorderColor="#E0E0E0" CornerRadius="12" HasShadow="False" HeightRequest="50">
                            <Grid ColumnDefinitions="40,*">
                                <Label Text="â€¹" FontSize="20" VerticalOptions="Center" HorizontalOptions="Center" Grid.Column="0"/>
                                <Label Text="Ø§Ù„Ø®Ø¨Ø±" FontSize="16" VerticalOptions="Center" Grid.Column="1"/>
                            </Grid>
                        </Frame>
                        <Frame BackgroundColor="#F5F5F5" BorderColor="#E0E0E0" CornerRadius="12" HasShadow="False" HeightRequest="50">
                            <Grid ColumnDefinitions="40,*">
                                <Label Text="â€¹" FontSize="20" VerticalOptions="Center" HorizontalOptions="Center" Grid.Column="0"/>
                                <Label Text="Ø§Ù„ØªØ­Ù„ÙŠØ©" FontSize="16" VerticalOptions="Center" Grid.Column="1"/>
                            </Grid>
                        </Frame>
                        <Frame BackgroundColor="#F5F5F5" BorderColor="#E0E0E0" CornerRadius="12" HasShadow="False" HeightRequest="50">
                            <Grid ColumnDefinitions="40,*">
                                <Label Text="â€¹" FontSize="20" VerticalOptions="Center" HorizontalOptions="Center" Grid.Column="0"/>
                                <Label Text="Ø§Ù„Ø´Ù…Ø§Ù„ Ø§Ù„Ø´Ø±Ù‚ÙŠ" FontSize="16" VerticalOptions="Center" Grid.Column="1"/>
                            </Grid>
                        </Frame>
                    </VerticalStackLayout>

                    <!-- STEP 3: Property Details -->
                    <VerticalStackLayout x:Name="Step3" Spacing="16" IsVisible="False">
                        <Label Text="ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¹Ù‚Ø§Ø±"
                               FontSize="18" FontAttributes="Bold" />
                        <Grid ColumnDefinitions="Auto,*,Auto" HorizontalOptions="Fill">
                            <Label Text="Ø§Ù„Ù…Ø³Ø§Ø­Ø©" FontSize="16" Grid.Column="0" VerticalOptions="Center" />
                            <Frame BackgroundColor="#F5F5F5" BorderColor="#E0E0E0" CornerRadius="12" WidthRequest="100" HeightRequest="50" Grid.Column="1" HorizontalOptions="Center">
                                <Entry Text="250" FontSize="16" HorizontalTextAlignment="Center"/>
                            </Frame>
                            <Label Text="Ù…ØªØ± Ù…Ø±Ø¨Ø¹" FontSize="16" Grid.Column="2" VerticalOptions="Center" />
                        </Grid>
                    </VerticalStackLayout>

                    <!-- STEP 4: Bedroom Counts -->
                    <VerticalStackLayout x:Name="Step4" Spacing="16" IsVisible="False">
                        <Label Text="ØªÙØ§ØµÙŠÙ„ ØºØ±Ù Ø§Ù„Ù†ÙˆÙ…"
                               FontSize="18" FontAttributes="Bold" />
                        <Grid ColumnDefinitions="Auto,*,Auto" VerticalOptions="Center">
                            <Button x:Name="IncrementBedroomButton" Text="+" FontSize="20" TextColor="#6200EE" BackgroundColor="Transparent" Clicked="OnIncrementBedroomClicked" />
                            <Frame WidthRequest="80" HeightRequest="50" BackgroundColor="#F5F5F5" BorderColor="#E0E0E0" CornerRadius="12">
                                <Label x:Name="BedroomCountLabel" Text="2" FontSize="18" HorizontalOptions="Center" VerticalOptions="Center" />
                            </Frame>
                            <Button x:Name="DecrementBedroomButton" Text="â€“" FontSize="20" TextColor="#6200EE" BackgroundColor="Transparent" Clicked="OnDecrementBedroomClicked" />
                        </Grid>
                    </VerticalStackLayout>

                    <!-- STEP 5: Bathroom Counts -->
                    <VerticalStackLayout x:Name="Step5" Spacing="16" IsVisible="False">
                        <Label Text="ØªÙØ§ØµÙŠÙ„ Ø¯ÙˆØ±Ø§Øª Ø§Ù„Ù…ÙŠØ§Ù‡"
                               FontSize="18" FontAttributes="Bold" />
                        <Grid ColumnDefinitions="Auto,*,Auto" VerticalOptions="Center">
                            <Button x:Name="IncrementBathroomButton" Text="+" FontSize="20" TextColor="#6200EE" BackgroundColor="Transparent" Clicked="OnIncrementBathroomClicked" />
                            <Frame WidthRequest="80" HeightRequest="50" BackgroundColor="#F5F5F5" BorderColor="#E0E0E0" CornerRadius="12">
                                <Label x:Name="BathroomCountLabel" Text="2" FontSize="18" HorizontalOptions="Center" VerticalOptions="Center" />
                            </Frame>
                            <Button x:Name="DecrementBathroomButton" Text="â€“" FontSize="20" TextColor="#6200EE" BackgroundColor="Transparent" Clicked="OnDecrementBathroomClicked" />
                        </Grid>
                    </VerticalStackLayout>

                    <!-- STEP 6: Additional Amenities -->
                    <VerticalStackLayout x:Name="Step6" Spacing="16" IsVisible="False">
                        <Label Text="Ø§Ù„Ù…Ø±Ø§ÙÙ‚ Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ©"
                               FontSize="18" FontAttributes="Bold" />
                        <Label Text="Ø§Ø®ØªÙŠØ§Ø±ÙŠ" FontSize="14" TextColor="Gray" />
                        <FlexLayout Wrap="Wrap" JustifyContent="Start" AlignItems="Center">
                            <Frame Padding="10" Margin="4" BackgroundColor="#F5F5F5" BorderColor="#E0E0E0" CornerRadius="20" HasShadow="False">
                                <Label Text="Ø£Ù„Ø¹Ø§Ø¨ Ø£Ø·ÙØ§Ù„" FontSize="14" TextColor="#6200EE" />
                            </Frame>
                            <Frame Padding="10" Margin="4" BackgroundColor="#6200EE" CornerRadius="20" HasShadow="False">
                                <Label Text="Ø¥Ø¶Ø§Ø¡Ø© Ø¥Ø¶Ø§ÙÙŠØ©" FontSize="14" TextColor="White" />
                            </Frame>
                        </FlexLayout>
                    </VerticalStackLayout>

                    <!-- STEP 7: Property Features -->
                    <VerticalStackLayout x:Name="Step7" Spacing="16" IsVisible="False">
                        <Label Text="Ù…Ù…ÙŠØ²Ø§Øª Ø§Ù„Ø¹Ù‚Ø§Ø±"
                               FontSize="18" FontAttributes="Bold" />
                        <Label Text="Ø§Ø®ØªÙŠØ§Ø±ÙŠ" FontSize="14" TextColor="Gray" />
                        <Grid ColumnDefinitions="*,*,*" RowSpacing="10" ColumnSpacing="10">
                            <Frame Grid.Row="0" Grid.Column="0" Padding="10" BackgroundColor="#F5F5F5" BorderColor="#E0E0E0" CornerRadius="12" HasShadow="False">
                                <StackLayout Spacing="4" HorizontalOptions="Center">
                                    <Label Text="ðŸŒ³" FontSize="24" HorizontalOptions="Center" />
                                    <Label Text="Ø¥Ø·Ù„Ø§Ù„Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø­Ø¯ÙŠÙ‚Ø©" FontSize="14" HorizontalOptions="Center" />
                                </StackLayout>
                            </Frame>
                            <Frame Grid.Row="0" Grid.Column="1" Padding="10" BackgroundColor="#6200EE" CornerRadius="12" HasShadow="False">
                                <StackLayout Spacing="4" HorizontalOptions="Center">
                                    <Label Text="â›°ï¸" FontSize="24" TextColor="White" HorizontalOptions="Center" />
                                    <Label Text="Ø¥Ø·Ù„Ø§Ù„Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø¬Ø¨Ù„" FontSize="14" TextColor="White" HorizontalOptions="Center" />
                                </StackLayout>
                            </Frame>
                        </Grid>
                    </VerticalStackLayout>

                    <!-- STEP 8: Description -->
                    <VerticalStackLayout x:Name="Step8" Spacing="16" IsVisible="False">
                        <Label Text="ÙˆØµÙ Ø§Ù„Ø¹Ù‚Ø§Ø±"
                               FontSize="18" FontAttributes="Bold" />
                        <Label Text="Ø£Ø¶Ù ÙˆØµÙ Ù…Ù…ÙŠØ² Ù„Ø¹Ù‚Ø§Ø±Ùƒ ÙˆØ§ÙŠØ´ ÙŠØªÙˆÙ‚Ø¹ Ø§Ù„Ø¶ÙŠÙ Ø£Ù† ÙŠØ¬Ø¯ ÙÙŠÙ‡"
                               FontSize="14" TextColor="Gray" />
                        <Frame BackgroundColor="#F5F5F5" BorderColor="#E0E0E0" CornerRadius="12" HasShadow="False" HeightRequest="200">
                            <Editor x:Name="PropertyDescription"
                                    Text="Ø£ÙØ¶Ù„ ÙÙ†Ø¯Ù‚ ÙÙŠ Ø§Ù„Ø¹Ø§Ù„Ù…"
                                    FontSize="16"
                                    Margin="10" />
                        </Frame>
                    </VerticalStackLayout>

                </VerticalStackLayout>
            </HorizontalStackLayout>
        </ScrollView>

        <!-- BOTTOM BAR with Progress Bar -->
        <Border
            Grid.Row="1"
            BackgroundColor="White"
            Stroke="#6200EE"
            StrokeThickness="2"
            HorizontalOptions="Center"
            WidthRequest="500">
            <Border.StrokeShape>
                <RoundRectangle CornerRadius="20,20,0,0" />
            </Border.StrokeShape>

            <Grid Padding="20,20,20,10">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>

                <!-- Progress Bar aligned with the stroke -->
                <Grid Grid.Row="0" HorizontalOptions="Center" Margin="0,-12,0,0">
                    <BoxView
                        x:Name="ProgressStrokeFill"
                        HeightRequest="8"
                        WidthRequest="57.5"
                        BackgroundColor="#6200EE"
                        CornerRadius="4"
                        HorizontalOptions="Start" />
                </Grid>

                <!-- Next button, centered and fixed width -->
                <Button
                    Grid.Row="1"
                    x:Name="NextButton"
                    Text="Ø§Ù„ØªØ§Ù„ÙŠ"
                    BackgroundColor="#6200EE"
                    TextColor="White"
                    CornerRadius="12"
                    HeightRequest="50"
                    WidthRequest="300"
                    HorizontalOptions="Center"
                    Margin="0,10,0,0"
                    Clicked="OnNextClicked" />
            </Grid>
        </Border>
    </Grid>
</ContentPage>